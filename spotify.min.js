const clientId="2e47dbcf9a124119b201fc2317857161",userId="216gnbjmuaymplnl65aplqvdq",playlistId="2hgfjOEcFDKn5lslZ95eo6",userIdToName={"216gnbjmuaymplnl65aplqvdq":"Étienne",aurelieprz:"Aurélie",11185354267:"Matthias","cami.michel":"Camille","217gbyebhc5ndxlx4hx7ub4da":"Aurélie"},nameToColor={"Aurélie":"sun_flower","Étienne":"wet_asphalt",Matthias:"amethyst",Camille:"turquoise"},hostOAuth="accounts.spotify.com",hostSpotify="api.spotify.com",redirectURL=`${window.location.origin}${window.location.pathname}`;function buildURL(e,t){return`https://${e}/${t.join("/")}`}function mkOAuthImplicitURL(e,t){const n=buildURL(hostOAuth,["authorize"]),a=new URLSearchParams;return a.append("response_type","token"),a.append("client_id",e),a.append("redirect_uri",t),a.append("scope","playlist-read-collaborative"),`${n}?${a}`}function parseOAuthToken(e=""){return e.replace("#","").split("&").map(e=>e.split("=")).filter(([e,t])=>"access_token"==e).map(([e,t])=>t).pop()}function mkClient(e){const t=new Headers;return t.append("Authorization",`Bearer ${e}`),t.append("Accept","application/json"),async(e,n)=>fetch(e,Object.assign({headers:t},n)).then(e=>e.json())}function countOn(e,t){return e.reduce((e,n)=>{const a=t(n);return e[a]=(e[a]||0)+1,e},{})}async function getTracks(e,t,n){const a=buildURL(hostSpotify,["v1","users",t,"playlists",n,"tracks"]);let i=0,o=[];do{const t=new URLSearchParams;t.append("limit",100),t.append("offset",i);var r=await e(`${a}?${t}`);o.push(...r.items),i+=100}while(r.items.length>0);return o}function createColumn(e,t,n){const a=document.createElement("div");a.className=n;const i=document.createElement("div");i.innerHTML=e;const o=document.createElement("div");return o.innerHTML=t,a.appendChild(i),a.appendChild(o),a}function map(e,t){return Object.keys(e).map(n=>t([n,e[n]]))}async function main(){const e=parseOAuthToken(window.location.hash);if(!e)return void(window.location.href=mkOAuthImplicitURL(clientId,redirectURL));const t=mkClient(e);try{var n=await getTracks(t,userId,playlistId)}catch(e){return void alert(`Failed to fetch playlist from Spotify: ${e}`)}const a=map(countOn(n,e=>userIdToName[e.added_by.id]),([e,t])=>createColumn(e,t,nameToColor[e])),i=document.querySelector("main");a.forEach(e=>i.appendChild(e))}main();